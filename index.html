<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>puppetteer bed radiance lurk gecko red flower blossom confetti sim spider with a top hat blast raspberry panzerfaust rainbow fist punch heart attack bacon kitty hawaiian nightmare summer banana polymorphisme will this title fit?</title>
  <link rel="stylesheet" href="css/style.css" type="text/css">
  <link rel="stylesheet" href="css/game_grid.css" type="text/css">
  <script>
    var gMap = '';
    var gPlayer;
    var gScore = 0;
    var gScoreDiv;
    var gHpDiv;
    var gBasicEnemiesArr = [];
    var gBossThreshold = 0.0;
    var gGameContainer = null;
    
    var gCoolBassLine = null;
    var gMusicActive = false;
  </script>
  <script src="js/tools.js"></script>
  <script src="js/grid.js"></script>
  <script src="js/Player.js"></script>
  <script src="js/Keys.js"></script>
  <script src="js/PowerUp.js"></script>
  <script src="js/GenericEnemy.js"></script>
  <script src="js/BasicEnemy.js"></script>
  <script src="js/BossEnemy.js"></script>
  <script src="js/Ruby.js"></script>
  <script>
    window.onload = function(){
      gMap = new Map();
      gPlayer = new Player();
      gScoreDiv = document.getElementById('score');
      gHpDiv = document.getElementById('hp');
      gGameContainer = document.getElementById('game_container');
      gCoolBassLine = document.getElementById('cool_bass_line');
        
      nextMap();
    };
    function wipeMap()
    {
      gBasicEnemiesArr.forEach(
          function(e)
          {
            e.hp = 0;
          });
      gBasicEnemiesArr = [];
      gMap.wipe();
    }
    function nextMap()
    {
      let string = 'rotateX(' + 30 * gBossThreshold + 'deg)';
      gGameContainer.style.transform = string;
      gGameContainer.style.WebkitTransform = string;
      
      wipeMap();
      
      gPlayer.position = gMap.nextMap();
      gPlayer.spawnAtPosition();
      for (let i = 0; i <= getRandomInt(0, 2); i++) {
        new PowerUp().spawner();
      }
      for (let i = 0; i <= getRandomInt(3, 15); i++)
      {
        let enemy = 
            Math.random() > gBossThreshold ?
                new BasicEnemy():
                new BossEnemy();
        gBasicEnemiesArr.push(enemy);
        enemy.spawner();
      }
      gBasicEnemiesArr.forEach(function (enemy){
        enemy.play();
      });
      for(let i = 0; i <= getRandomInt(3, 13); i++){
        new Ruby().spawner();
      }
      
      gBossThreshold += 0.1;
    }
    function updateScore(){
      let string = 'Rubies : <span class="rubies">';
      for (let i = 0; i < gScore; i++){
        string += 'ðŸ’Ž';
      }
      gScoreDiv.innerHTML = string + "</span>";
    }
    function updateHp(){
      gHpDiv.innerHTML = gPlayer.hp + "/" + gPlayer.maxHp;
    }
  </script>
</head>
<body>
  <audio id="cool_bass_line">
    <source src="sound/lamerde.wav" type="audio/wav">
  </audio>
  <header>
    <p id="score">Rubies : </p>
    <p id="hp">15/15</p>
  </header>
  <nav>
    nav here
  </nav>
  <main>
    main here
    <div id="game_container">
      game container here
    </div>
  </main>
  <footer>
    footer here
  </footer>
</body>
</html>